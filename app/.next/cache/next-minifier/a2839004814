{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{\"2vqT\":function(t,n,e){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0}),n.useCurrentPosition=function(t){var n=i((0,r.useState)(),2),e=n[0],a=n[1],o=i((0,r.useState)(),2),u=o[0],c=o[1];return(0,r.useEffect)((function(){var n=!1;return navigator.geolocation.getCurrentPosition((function(t){n||a(t)}),(function(t){n||c(t)}),t),function(){n=!0}}),[t]),[e,u]};var r=e(\"q1tI\");function i(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(e.push(o.value),!n||e.length!==n);r=!0);}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return e}(t,n)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}},\"5Ljo\":function(t,n,e){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0}),Object.defineProperty(n,\"useCurrentPosition\",{enumerable:!0,get:function(){return r.useCurrentPosition}}),Object.defineProperty(n,\"useWatchPosition\",{enumerable:!0,get:function(){return i.useWatchPosition}});var r=e(\"2vqT\"),i=e(\"7F5W\")},\"5jIz\":function(t,n,e){\"use strict\";e.r(n),e.d(n,\"default\",(function(){return M}));var r=e(\"9Jkg\"),i=e.n(r),a=e(\"0iUn\"),o=e(\"sLSF\"),u=e(\"MI3g\"),c=e(\"a7VT\"),s=e(\"Tit0\"),l=e(\"rt45\"),f=e(\"q1tI\"),d=e.n(f),h=e(\"vOnD\"),v=e(\"KYPV\"),p=(e(\"vBfy\"),e(\"vcXL\")),b=e.n(p),y=e(\"Z3vd\"),m=e(\"8Kt/\"),g=e.n(m),j=e(\"vgmO\"),w=e.n(j),O=(e(\"VrOB\"),e(\"YKRf\"),e(\"jkUL\")),I=e.n(O),k=(e(\"Bb0u\"),e(\"5Ljo\")),x=d.a.createElement;function P(){var t=Object(l.a)([\"\\n  color: tomato;\\n  border-color: tomato;\\n  width: 80%;\\n\"]);return P=function(){return t},t}function T(){var t=Object(l.a)([\"\\n  width: 80%;\\n  variant: contained;\\n\"]);return T=function(){return t},t}function C(){var t=Object(l.a)([\"\\n  width: 60vw;\\n  margin: auto;\\n\"]);return C=function(){return t},t}function A(){var t=Object(l.a)([\"\\n  text-align: center;\\n  padding-top: 2em;\\n  padding-bottom: 2em;\\n\"]);return A=function(){return t},t}function F(){var t=Object(l.a)([\"\\n  background: #F7F9FA;\\n  height: 90vh;\\n  width: 80vw;\\n  margin: 5em auto;\\n  display:flex;\\n  align-items:center;\\n  justify-content:center;\\n  box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.4);\\n\\n  label {\\n    font-family: Candara;\\n    color: #1C2833;\\n    font-size: 1.2em;\\n    font-weight: 400;\\n  }\\n\"]);return F=function(){return t},t}function _(){var t=Object(l.a)([\"\\n  color: #F8F9F9;\\n  font-family: Candara;\\n  text-align: center;\\n  margin-bottom:-2em;\\n\"]);return _=function(){return t},t}function E(){var t=Object(l.a)([\"\\n  margin: 5.5em auto;\\n  width: 80vw;\\n  height: 64vh;\\n  display:flex;\\n  align-items:center;\\n  justify-content:center;\\n\"]);return E=function(){return t},t}function S(){var t=Object(l.a)([\"\\n  display: table;\\n  margin: 0 auto;\\n\"]);return S=function(){return t},t}e(\"5Buo\");e(\"ubkq\");var L=w.a.liff,q=h.a.div(S()),z=h.a.div(E()),W=(h.a.h2(_()),h.a.div(F()),Object(h.a)(v.Form)(A()),Object(h.a)(v.Field)(C()),Object(h.a)(y.a)(T())),M=(h.a.button(P()),function(t){function n(t){var e;return Object(a.a)(this,n),(e=Object(u.a)(this,Object(c.a)(n).call(this,t))).state={substitutes:[],userId:null},e}return Object(s.a)(n,t),Object(o.a)(n,[{key:\"componentDidMount\",value:function(){this.liffInit(),this.getLocation()}},{key:\"liffInit\",value:function(){var t=this;try{L.init((function(n){var e=n.context.userId,r=L.getAccessToken(),a={userId:e};b()(\"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\",{method:\"post\",headers:{\"Content-Type\":\"application/json\"},body:i()(a)}).then((function(t){return t.text()})).then((function(n){n?(t.setState({userId:e}),t.lineAuth(e,r)):(alert(\"\\u8acb\\u767b\\u5165\\u4ee5\\u67e5\\u770b\\u5047\\u55ae\"),w.a.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\"))}))}),(function(t){alert(t.message)}))}catch(n){next(n)}}},{key:\"lineAuth\",value:function(t,n){var e=this;try{var r={userId:t,accessToken:n};b()(\"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\",{method:\"post\",headers:{\"Content-Type\":\"application/json\"},body:i()(r)}).then((function(t){return t.json()})).then((function(t){if(t){var n=t.staff.ubn,r=(t.staff.department,t.staff.email),i=t.token.idToken;e.setState({Authorization:i,ubn:n,email:r})}else alert(\"lineAuth no result\")})).catch((function(t){alert(t.message)}))}catch(a){next(a)}}},{key:\"getLocation\",value:function(){try{alert(\"getLocation\"),Object(k.useCurrentPosition)()}catch(t){next(t)}}},{key:\"punchIn\",value:function(){try{b()(\"https://us-central1-teddybear-dev.cloudfunctions.net/api/punch/create\",{method:\"post\",headers:{Authorization:this.state.Authorization,ubn:this.state.ubn,\"Content-Type\":\"application/json\"},body:{latitude:this.state.latitude,longitude:this.state.longitude,type:\"in\",email:this.state.email}}).then((function(t){return t.text()})).then((function(t){t?alert(\"punch in success\"):alert(\"punch error\")})).catch((function(t){alert(t.message)}))}catch(t){next(t)}}},{key:\"render\",value:function(){var t=this;return x(z,null,x(g.a,null,x(\"script\",{src:\"https://d.line-scdn.net/liff/1.0/sdk.js\"})),x(\"body\",{style:{background:\"#34495E\"}},x(z,null,this.state.email?x(W,{fontFamily:\"Candara\",variant:\"contained\",color:\"secondary\",disabled:!this.state.latitude|!this.state.longitude,onClick:function(){t.punchIn()}},\"\\u7c3d\\u5230\"):x(q,null,x(I.a,{type:\"ThreeDots\",color:\"#f50057\",height:80,width:80})))))}}]),n}(f.Component))},\"7F5W\":function(t,n,e){\"use strict\";Object.defineProperty(n,\"__esModule\",{value:!0}),n.useWatchPosition=function(t){var n=i((0,r.useState)(null),2),e=n[0],a=n[1],o=i((0,r.useState)(null),2),u=o[0],c=o[1];return(0,r.useEffect)((function(){var n=navigator.geolocation.watchPosition(a,c,t);return function(){return navigator.geolocation.clearWatch(n)}}),[t]),[e,u]};var r=e(\"q1tI\");function i(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],r=!0,i=!1,a=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done)&&(e.push(o.value),!n||e.length!==n);r=!0);}catch(c){i=!0,a=c}finally{try{r||null==u.return||u.return()}finally{if(i)throw a}}return e}(t,n)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}},tPI5:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/punchIn\",function(){return e(\"5jIz\")}])}},[[\"tPI5\",1,0]]]);"}