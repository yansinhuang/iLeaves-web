{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/yan/ezbot-web/app/pages/createLeave.js\";\nvar __jsx = React.createElement;\n\nfunction _templateObject7() {\n  var data = _taggedTemplateLiteral([\"\\n  color: tomato;\\n  border-color: tomato;\\n  width: 80%;\\n\"]);\n\n  _templateObject7 = function _templateObject7() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject6() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 80%;\\n  variant: contained;\\n\"]);\n\n  _templateObject6 = function _templateObject6() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject5() {\n  var data = _taggedTemplateLiteral([\"\\n  width: 80%;\\n\"]);\n\n  _templateObject5 = function _templateObject5() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject4() {\n  var data = _taggedTemplateLiteral([\"\\n  text-align: center;\\n  padding-top: 2em;\\n  padding-bottom: 2em;\\n\"]);\n\n  _templateObject4 = function _templateObject4() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject3() {\n  var data = _taggedTemplateLiteral([\"\\n  background: #F7F9FA;\\n  height: auto;\\n  width: 90%;\\n  margin: 5em auto;\\n  box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.4);\\n\\n  label {\\n    font-family: Candara;\\n    color: #1C2833;\\n    font-size: 1.2em;\\n    font-weight: 400;\\n  }\\n\"]);\n\n  _templateObject3 = function _templateObject3() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject2() {\n  var data = _taggedTemplateLiteral([\"\\n  color: #F8F9F9;\\n  font-family: Candara;\\n  text-align: center;\\n  margin-bottom:-2em;\\n\"]);\n\n  _templateObject2 = function _templateObject2() {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  margin: 5.5em auto;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\n// Render Prop\nimport React from 'react';\nimport styled from 'styled-components';\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport { TextField } from 'formik-material-ui';\nimport fetch from 'isomorphic-unfetch';\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport icon from '../components/image/icon.png';\nimport Head from 'next/head';\nimport window from 'global';\nimport DatePicker from \"react-datepicker\";\nimport { Select } from 'material-ui-formik-components/Select';\n\nrequire(\"react-datepicker/dist/react-datepicker.css\");\n\nvar liff = window.liff;\nvar BOX = styled.div(_templateObject());\nvar TITLE = styled.h2(_templateObject2());\nvar CONTAINER = styled.div(_templateObject3());\nvar MYFORM = styled(Form)(_templateObject4());\nvar FIELD = styled(Field)(_templateObject5());\nvar BUTTON = styled(Button)(_templateObject6());\nvar TomatoButton = styled.button(_templateObject7());\n\nvar liffInit = function liffInit() {\n  return _regeneratorRuntime.async(function liffInit$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          liff.init(function (data) {\n            var userId = data.context.userId;\n            var accessToken = liff.getAccessToken(); //alert(\"success\");\n            //alert(userId);\n\n            var URL_CHECKEXIST = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\";\n            var body = {\n              userId: userId\n            };\n            fetch(URL_CHECKEXIST, {\n              method: 'post',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: _JSON$stringify(body)\n            }).then(function (res) {\n              return res.text();\n            }).then(function (result) {\n              if (result) {\n                alert(userId);\n                alert(accessToken);\n                lineAuth(userId, accessToken);\n              } else {\n                alert(\"請登入以查看假單\");\n                window.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\");\n              }\n            });\n          }, function (err) {\n            alert(\"error\");\n          });\n\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nvar lineAuth = function lineAuth(userId, accessToken) {\n  var url, body;\n  return _regeneratorRuntime.async(function lineAuth$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          url = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n          body = {\n            userId: userId,\n            accessToken: accessToken\n          };\n          fetch(url, {\n            method: 'post',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: _JSON$stringify(body)\n          }).then(function (res) {\n            return res.json();\n          }).then(function (result) {\n            if (result) {\n              alert(\"success\"); //alert(result.staff);\n              //alert(result);\n\n              var ubn = result.staff.ubn;\n              var department = result.staff.depertment;\n              var idToken = result.token.idToken;\n              getSubstitutes(ubn, department, idToken);\n            } else {\n              alert(\"lineAuth no result\");\n            }\n          })[\"catch\"](function (error) {\n            alert(error.message);\n          });\n\n        case 3:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  });\n};\n\nvar getSubstitutes = function getSubstitutes(ubn, department, accessToken) {\n  var URL_GETSUBSTITUTES, url, header;\n  return _regeneratorRuntime.async(function getSubstitutes$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          URL_GETSUBSTITUTES = \"https://https-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n          url = URL_GETSUBSTITUTES + \"?ubn=\".concat(ubn, \"&query=department&value=\").concat(department);\n          header = {\n            Authorization: accessToken\n          };\n          fetch(url, {\n            method: 'get',\n            headers: header\n          }).then(function (res) {\n            return res.json();\n          }).then(function (result) {\n            if (result) {\n              alert(\"success\");\n              createOptions(result.list);\n            } else {\n              alert(\"getSubstitutes no result\");\n            }\n          })[\"catch\"](function (error) {\n            alert(error.message);\n          });\n\n        case 4:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n};\n\nvar substitutes;\n\nvar createOptions = function createOptions(arr) {\n  var i, obj, newList;\n  return _regeneratorRuntime.async(function createOptions$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          for (i = 0; i < arr.length; i++) {\n            obj = JSON.parse(arr)[i];\n            obj.email = obj.value;\n            obj.name = obj.label;\n            delete obj.email;\n            delete obj.name; //push to list\n\n            newList = [];\n            newList.push(obj);\n          } // tell Basic that options have been changed\n\n\n          substitutes = newList;\n\n        case 2:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  });\n}; //liffInit();\n\n\nvar Basic = function Basic() {\n  return __jsx(BOX, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, __jsx(Head, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, __jsx(\"script\", {\n    src: \"https://d.line-scdn.net/liff/1.0/sdk.js\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  })), __jsx(\"body\", {\n    style: {\n      background: '#34495E'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, __jsx(BOX, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  }, __jsx(Formik, {\n    initialValues: {\n      startDate: '',\n      endDate: '',\n      leaveType: '',\n      leaveReason: ' ',\n      substitute: ' '\n    },\n    validate: function validate(values) {\n      var errors = {}; // check for ubn\n\n      if (!values.startDate) {\n        errors.startDate = 'Required';\n      } // check for email\n\n\n      if (!values.endDate) {\n        errors.endDate = 'Required';\n      } // check for leaveType\n\n\n      if (!values.leaveType) {\n        errors.leaveType = 'Required';\n      } // check for leaveReason\n\n\n      if (!values.leaveReason) {\n        errors.leaveReason = 'Required';\n      } // check for substitute\n\n\n      if (!values.substitute) {\n        errors.substitute = 'Required';\n      }\n\n      return errors;\n    },\n    onSubmit: function onSubmit(values, _ref) {\n      var setSubmitting = _ref.setSubmitting;\n      //submitForm(values, userId);\n      setTimeout(function () {\n        submitForm(values, userId);\n        setSubmitting(false);\n      }, 400); //console.log('submitting', values);\n      //setSubmitting(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178\n    },\n    __self: this\n  }, function (_ref2) {\n    var isSubmitting = _ref2.isSubmitting,\n        values = _ref2.values,\n        setFieldValue = _ref2.setFieldValue;\n    return __jsx(CONTAINER, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }, __jsx(MYFORM, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, __jsx(DatePicker, {\n      selected: values.startDate,\n      dateFormat: \"MMMM d, yyyy\",\n      className: \"form-control\",\n      name: \"startDate\",\n      label: \"\\u958B\\u59CB\\u65E5\\u671F\",\n      onChange: function onChange(date) {\n        return setFieldValue('startDate', date);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }), __jsx(DatePicker, {\n      selected: values.endDate,\n      dateFormat: \"MMMM d, yyyy\",\n      className: \"form-control\",\n      name: \"endDate\",\n      label: \"\\u7D50\\u675F\\u65E5\\u671F\",\n      onChange: function onChange(date) {\n        return setFieldValue('endDate', date);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }), __jsx(FIELD, {\n      type: \"leaveType\",\n      name: \"leaveType\",\n      label: \"\\u5047\\u52E4\\u985E\\u5225\",\n      component: TextField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }), __jsx(FIELD, {\n      type: \"leaveReason\",\n      name: \"leaveReason\",\n      label: \"\\u5047\\u52E4\\u4E8B\\u7531\",\n      component: TextField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }), __jsx(FIELD, {\n      type: \"substitute\",\n      name: \"substitute\",\n      label: \"\\u8077\\u52D9\\u4EE3\\u7406\\u4EBA\",\n      component: TextField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }), __jsx(Field, {\n      required: true,\n      name: \"substitute\",\n      label: \"\\u8077\\u52D9\\u4EE3\\u7406\\u4EBA\",\n      options: [{\n        value: '',\n        label: '-- No selection --'\n      }, {\n        value: 'Male',\n        label: 'Male'\n      }, {\n        value: 'Female',\n        label: 'Female'\n      }, {\n        value: 'Other',\n        label: 'Other'\n      }],\n      component: Select,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }), __jsx(BUTTON, {\n      type: \"submit\",\n      fontFamily: \"Candara\",\n      variant: \"contained\",\n      color: \"secondary\",\n      disabled: isSubmitting,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 252\n      },\n      __self: this\n    }, \"\\u9001\\u51FA\\u5047\\u55AE\")));\n  }))));\n};\n\nBasic.getInitialProps = function _callee(req) {\n  return _regeneratorRuntime.async(function _callee$(_context5) {\n    while (1) {\n      switch (_context5.prev = _context5.next) {\n        case 0:\n          liffInit();\n          return _context5.abrupt(\"return\", {\n            substitutes: substitutes\n          });\n\n        case 2:\n        case \"end\":\n          return _context5.stop();\n      }\n    }\n  });\n};\n\nexport default Basic;","map":{"version":3,"sources":["/Users/yan/ezbot-web/app/pages/createLeave.js"],"names":["React","styled","Formik","Form","Field","ErrorMessage","TextField","fetch","Button","Box","icon","Head","window","DatePicker","Select","require","liff","BOX","div","TITLE","h2","CONTAINER","MYFORM","FIELD","BUTTON","TomatoButton","button","liffInit","init","data","userId","context","accessToken","getAccessToken","URL_CHECKEXIST","body","method","headers","then","res","text","result","alert","lineAuth","location","replace","err","url","json","ubn","staff","department","depertment","idToken","token","getSubstitutes","error","message","URL_GETSUBSTITUTES","header","Authorization","createOptions","list","substitutes","arr","i","length","obj","JSON","parse","email","value","name","label","newList","push","Basic","background","startDate","endDate","leaveType","leaveReason","substitute","values","errors","setSubmitting","setTimeout","submitForm","isSubmitting","setFieldValue","date","getInitialProps","req"],"mappings":"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","sourcesContent":["// Render Prop\nimport React from 'react';\nimport styled from 'styled-components';\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport { TextField } from 'formik-material-ui';\nimport fetch from 'isomorphic-unfetch';\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport icon from '../components/image/icon.png';\nimport Head from 'next/head';\nimport window from 'global';\nimport DatePicker from \"react-datepicker\";\nimport { Select } from 'material-ui-formik-components/Select'\nrequire( \"react-datepicker/dist/react-datepicker.css\");\n\nconst liff = window.liff;\nconst BOX = styled.div`\n  margin: 5.5em auto;\n`;\nconst TITLE = styled.h2`\n  color: #F8F9F9;\n  font-family: Candara;\n  text-align: center;\n  margin-bottom:-2em;\n`;\nconst CONTAINER = styled.div`\n  background: #F7F9FA;\n  height: auto;\n  width: 90%;\n  margin: 5em auto;\n  box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.4);\n\n  label {\n    font-family: Candara;\n    color: #1C2833;\n    font-size: 1.2em;\n    font-weight: 400;\n  }\n`;\nconst MYFORM = styled(Form)`\n  text-align: center;\n  padding-top: 2em;\n  padding-bottom: 2em;\n`;\nconst FIELD = styled(Field)`\n  width: 80%;\n`;\nconst BUTTON = styled(Button)`\n  width: 80%;\n  variant: contained;\n`;\nconst TomatoButton = styled.button`\n  color: tomato;\n  border-color: tomato;\n  width: 80%;\n`;\n\nconst liffInit = async () => {\n    liff.init(data => {\n      const userId = data.context.userId;\n      const accessToken = liff.getAccessToken();\n      //alert(\"success\");\n      //alert(userId);\n      const URL_CHECKEXIST = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\";\n      const body = {\n        userId: userId\n      };\n      fetch(URL_CHECKEXIST, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      }).then((res) => {\n        return res.text();\n      }).then(result => {\n        if (result) {\n            alert(userId);\n            alert(accessToken);\n            lineAuth(userId, accessToken);\n        } else {\n            alert(\"請登入以查看假單\");\n            window.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\");\n        }\n      })\n      \n  \n    }, err => {\n      alert(\"error\");\n    });\n  }\n\nconst lineAuth = async(userId, accessToken) => {\n    const url = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n    const body = {\n        userId: userId,\n        accessToken: accessToken\n      };\n    fetch(url, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(body)\n      }).then((res) => {\n        return res.json();\n      }).then(result => {\n        if (result) {\n            alert(\"success\");\n            //alert(result.staff);\n            //alert(result);\n            const ubn = result.staff.ubn;\n            const department = result.staff.depertment;\n            const idToken = result.token.idToken;\n            getSubstitutes(ubn, department, idToken);\n        } else {\n            alert(\"lineAuth no result\");\n\n        }\n      }).catch(function (error) {\n        alert(error.message);\n      })\n}\n\nconst getSubstitutes = async(ubn, department, accessToken) => {\n  const URL_GETSUBSTITUTES = \"https://https-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n  const url = URL_GETSUBSTITUTES + `?ubn=${ubn}&query=department&value=${department}`; \n  const header = {\n      Authorization: accessToken\n    };\n  fetch(url, {\n      method: 'get',\n      headers: header\n    }).then((res) => {\n      return res.json();\n    }).then(result => {\n      if (result) {\n        alert(\"success\");\n        createOptions(result.list)\n\n\n\n      } else {\n          alert(\"getSubstitutes no result\");\n\n      }\n    }).catch(function (error) {\n      alert(error.message);\n    })\n}\nvar substitutes;\nconst createOptions = async(arr) => {\n  for (var i = 0; i < arr.length; i++) {\n    var obj = JSON.parse(arr)[i];\n    obj.email = obj.value;\n    obj.name = obj.label;\n    delete obj.email;\n    delete obj.name;\n    //push to list\n    var newList = [];\n    newList.push(obj);\n  }\n  // tell Basic that options have been changed\n  substitutes = newList;\n}\n\n//liffInit();\n\n\n\nconst Basic = () => (\n    <BOX>\n    <Head>\n      <script src=\"https://d.line-scdn.net/liff/1.0/sdk.js\"></script>\n    </Head>\n    <body style={{background:'#34495E'}}>\n      <BOX>\n        <Formik\n          initialValues={{ startDate: '', endDate: '', leaveType: '', leaveReason: ' ', substitute: ' ' }}\n          validate={values => {\n            const errors = {};\n            // check for ubn\n            if (!values.startDate) {\n              errors.startDate = 'Required';\n            }\n            // check for email\n            if (!values.endDate) {\n              errors.endDate = 'Required';\n            } \n            // check for leaveType\n            if (!values.leaveType) {\n              errors.leaveType = 'Required';\n            }\n            // check for leaveReason\n            if (!values.leaveReason) {\n                errors.leaveReason = 'Required';\n            }\n            // check for substitute\n            if (!values.substitute) {\n                errors.substitute = 'Required';\n            }\n            return errors;\n          }}\n          onSubmit={(values, { setSubmitting }) => {\n            //submitForm(values, userId);\n  \n            setTimeout(() => {\n              submitForm(values, userId);\n              setSubmitting(false);\n            }, 400);\n            \n            //console.log('submitting', values);\n            //setSubmitting(false);\n          }}\n        >\n          {({ isSubmitting, values, setFieldValue}) => (\n            <CONTAINER>\n            <MYFORM>\n            <DatePicker \n              selected={values.startDate}\n              dateFormat=\"MMMM d, yyyy\"\n              className=\"form-control\"\n              name=\"startDate\"\n              label = \"開始日期\"\n              onChange={date => setFieldValue('startDate', date)}\n            />\n            <DatePicker \n              selected={values.endDate}\n              dateFormat=\"MMMM d, yyyy\"\n              className=\"form-control\"\n              name=\"endDate\"\n              label = \"結束日期\"\n              onChange={date => setFieldValue('endDate', date)}\n            />\n              <FIELD type=\"leaveType\" name=\"leaveType\" label = \"假勤類別\" component = { TextField }/>\n              <FIELD type=\"leaveReason\" name=\"leaveReason\" label = \"假勤事由\" component = { TextField }/>\n              <FIELD type=\"substitute\" name=\"substitute\" label = \"職務代理人\" component = { TextField }/>\n              <Field\n                required\n                name=\"substitute\"\n                label=\"職務代理人\"\n                options={[\n                  { value: '', label: '-- No selection --' },\n                  { value: 'Male', label: 'Male' },\n                  { value: 'Female', label: 'Female' },\n                  { value: 'Other', label: 'Other' },\n                ]}\n                component={Select}\n              />\n              <br></br>\n              <br></br>\n              <BUTTON\n              type=\"submit\"\n              fontFamily= \"Candara\"\n              variant=\"contained\"\n              color=\"secondary\"\n              disabled={isSubmitting}\n            >\n              送出假單\n            </BUTTON>\n            </MYFORM>\n            </CONTAINER>\n          )}\n        </Formik>\n      </BOX>\n    </body>\n    </BOX>\n    \n  );\n  \n  Basic.getInitialProps = async (req) => {\n    liffInit();\n    return {\n      substitutes: substitutes\n    }\n  }\n\n  export default Basic;"]},"metadata":{},"sourceType":"module"}