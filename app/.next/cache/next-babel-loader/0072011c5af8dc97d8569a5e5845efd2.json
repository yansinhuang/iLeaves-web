{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar __jsx = React.createElement;\nimport Head from 'next/head';\nimport React, { Component } from 'react';\nimport ReactTable from \"react-table\";\nimport \"react-table/react-table.css\";\n\nvar liffInit = function liffInit() {\n  return _regeneratorRuntime.async(function liffInit$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          liff.init(function (data) {\n            var userId = data.context.userId;\n            var accessToken = liff.getAccessToken(); //alert(\"success\");\n            //alert(userId);\n\n            var URL_CHECKEXIST = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\";\n            var body = {\n              userId: userId\n            };\n            fetch(URL_CHECKEXIST, {\n              method: 'post',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: _JSON$stringify(body)\n            }).then(function (res) {\n              return res.text();\n            }).then(function (result) {\n              if (result) {\n                alert(userId);\n                alert(accessToken);\n                lineAuth(userId, accessToken);\n              } else {\n                alert(\"請登入以查看假單\");\n                window.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\");\n              }\n            });\n          }, function (err) {\n            alert(\"error\");\n          });\n\n        case 1:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  });\n};\n\nvar lineAuth = function lineAuth(userId, accessToken) {\n  var url, body;\n  return _regeneratorRuntime.async(function lineAuth$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          url = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n          body = {\n            userId: userId,\n            accessToken: accessToken\n          };\n          fetch(url, {\n            method: 'post',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: _JSON$stringify(body)\n          }).then(function (res) {\n            return res.json();\n          }).then(function (result) {\n            if (result) {\n              alert(\"success\"); //alert(result.staff);\n              //alert(result);\n\n              var ubn = result.staff.ubn;\n              var email = result.staff.email;\n              var idToken = result.token.idToken;\n              getLeaves(ubn, email, idToken);\n            } else {\n              alert(\"lineAuth no result\");\n            }\n          })[\"catch\"](function (error) {\n            alert(error.message);\n          });\n\n        case 3:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  });\n};\n\nvar getLeaves = function getLeaves(ubn, email, idToken) {\n  var url_pre, url, header;\n  return _regeneratorRuntime.async(function getLeaves$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          url_pre = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/leave/get\";\n          url = url_pre + \"?ubn=\".concat(ubn, \"&query=email&value=\").concat(email);\n          header = {\n            Authorization: idToken\n          };\n          fetch(url, {\n            method: 'get',\n            headers: header\n          }).then(function (res) {\n            return res.text();\n          }).then(function (result) {\n            if (result) {\n              alert(\"success\");\n            } else {\n              alert(\"getLeaves no result\");\n            }\n          })[\"catch\"](function (error) {\n            alert(error.message);\n          });\n\n        case 4:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  });\n};\n\nliffInit();\n\nvar Basic = function Basic() {\n  return __jsx(Head, null, __jsx(\"script\", {\n    src: \"https://d.line-scdn.net/liff/1.0/sdk.js\"\n  }));\n}; //export default Basic;\n\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App() {\n    _classCallCheck(this, App);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(App).apply(this, arguments));\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var data = [{\n        name: 'Roy Agasthyan',\n        age: 26\n      }, {\n        name: 'Sam Thomason',\n        age: 22\n      }, {\n        name: 'Michael Jackson',\n        age: 36\n      }, {\n        name: 'Samuel Roy',\n        age: 56\n      }, {\n        name: 'Rima Soy',\n        age: 28\n      }, {\n        name: 'Suzi Eliamma',\n        age: 28\n      }];\n      var columns = [{\n        Header: 'Name',\n        accessor: 'name'\n      }, {\n        Header: 'Age',\n        accessor: 'age'\n      }];\n      return __jsx(\"div\", null, __jsx(ReactTable, {\n        data: data,\n        columns: columns,\n        defaultPageSize: 3,\n        pageSizeOptions: [3, 6]\n      }));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport { App as default };","map":null,"metadata":{},"sourceType":"module"}