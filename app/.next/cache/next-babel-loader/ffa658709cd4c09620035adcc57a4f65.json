{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/yan/ezbot-web/app/pages/viewSign.js\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  margin: 5.5em auto;\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport Head from 'next/head';\nimport React, { Component } from 'react';\nimport ReactTable from \"react-table\";\nimport styled from 'styled-components';\nimport \"react-table/react-table.css\";\nimport window from 'global';\nimport Loader from \"./loader\";\n\nrequire('react-month-picker-input/dist/react-month-picker-input.css');\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Grid from '@material-ui/core/Grid';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    formControl: {\n      margin: theme.spacing(1),\n      minWidth: 120,\n      fullWidth: true\n    },\n    selectEmpty: {\n      marginTop: theme.spacing(2)\n    }\n  };\n});\nvar liff = window.liff;\nvar BOX = styled.div(_templateObject());\nvar leaves;\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"handleRoleChange\", function (event) {\n      try {\n        _this.setState({\n          role: event.target.value\n        }, function () {\n          if (event.target.value == \"substitute\") {\n            _this.getLeavesSub(_this.state.ubn, _this.state.name, _this.state.email, _this.state.idToken);\n          } else if (event.target.value == \"supervisor\") {\n            _this.getLeavesSuper(_this.state.ubn, _this.state.email, _this.state.idToken);\n          }\n        });\n      } catch (err) {\n        throw err;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleStatusChange\", function (event) {\n      try {\n        _this.setState({\n          status: event.target.value\n        }, function () {\n          //console.log(event.target.value);\n          _this.globalSearch();\n        });\n      } catch (err) {\n        throw err;\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"globalSearch\", function () {\n      try {\n        _this.setState({\n          loading: true\n        });\n\n        var role_select = _this.state.role;\n        var status_select = _this.state.status;\n\n        var filteredData = _this.state.data_origin.filter(function (value) {\n          if (role_select == \"substitute\") {\n            switch (status_select) {\n              case \"signed\":\n                return value.status != \"等待簽核\";\n\n              case \"not signed\":\n                return value.status == \"等待簽核\";\n\n              default:\n                throw 'Option not supported';\n            }\n          } else if (role_select == \"supervisor\") {\n            switch (status_select) {\n              case \"signed\":\n                return value.status == \"同意 (主管)\" || value.status == \"拒絕 (主管)\";\n\n              case \"not signed\":\n                return value.status == \"同意 (代理人)\";\n\n              default:\n                throw 'Option not supported';\n            }\n          }\n        });\n\n        _this.setState({\n          data: filteredData,\n          loading: false\n        });\n      } catch (err) {\n        throw err;\n      }\n    });\n\n    _this.state = {\n      data: null,\n      data_origin: null,\n      role: \"substitute\",\n      status: \"not signed\",\n      loading: fal\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.liffInit();\n    }\n  }, {\n    key: \"liffInit\",\n    value: function liffInit() {\n      var _this2 = this;\n\n      try {\n        liff.init(function (data) {\n          var userId = data.context.userId;\n          var accessToken = liff.getAccessToken();\n          var URL_CHECKEXIST = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\";\n          var body = {\n            userId: userId\n          };\n          fetch(URL_CHECKEXIST, {\n            method: 'post',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: _JSON$stringify(body)\n          }).then(function (res) {\n            return res.text();\n          }).then(function (result) {\n            if (result) {\n              _this2.lineAuth(userId, accessToken);\n            } else {\n              alert(\"請登入以查看假單\");\n              window.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\");\n            }\n          });\n        }, function (err) {\n          alert(\"error\");\n        });\n      } catch (err) {\n        throw err;\n      }\n    }\n  }, {\n    key: \"lineAuth\",\n    value: function lineAuth(userId, accessToken) {\n      var _this3 = this;\n\n      try {\n        var url = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n        var body = {\n          userId: userId,\n          accessToken: accessToken\n        };\n        fetch(url, {\n          method: 'post',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: _JSON$stringify(body)\n        }).then(function (res) {\n          return res.json();\n        }).then(function (result) {\n          if (result) {\n            var ubn = result.staff.ubn;\n            var email = result.staff.email;\n            var name = result.staff.name;\n            var idToken = result.token.idToken;\n\n            _this3.setState({\n              ubn: ubn,\n              name: name,\n              email: email,\n              idToken: idToken\n            });\n\n            if (_this3.state.role == \"substitute\") {\n              _this3.getLeavesSub(_this3.state.ubn, _this3.state.name, _this3.state.email, _this3.state.idToken);\n            } else if (_this3.state.role == \"supervisor\") {\n              _this3.getLeavesSuper(_this3.state.ubn, _this3.state.email, _this3.state.idToken);\n            }\n          } else {\n            alert(\"lineAuth no result\");\n          }\n        })[\"catch\"](function (error) {\n          alert(error.message);\n        });\n      } catch (err) {\n        throw err;\n      }\n    }\n  }, {\n    key: \"getLeavesSub\",\n    value: function getLeavesSub(ubn, name, email, idToken) {\n      var _this4 = this;\n\n      try {\n        this.setState({\n          loading: true\n        });\n        var URL_GETLEAVES = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/leave/get\";\n        var url = URL_GETLEAVES + \"?ubn=\".concat(ubn, \"&query=substitute&value={\\\"name\\\":\\\"\").concat(name, \"\\\",\\\"email\\\":\\\"\").concat(email, \"\\\"}\");\n        var header = {\n          Authorization: idToken\n        };\n        fetch(url, {\n          method: 'get',\n          headers: header\n        }).then(function (res) {\n          return res.json();\n        }).then(function (result) {\n          if (result) {\n            _this4.convertData(result.list);\n          } else {\n            alert(\"getLeavesSub no result\");\n          }\n        })[\"catch\"](function (error) {\n          alert(error.message);\n        });\n      } catch (err) {\n        throw err;\n      }\n    }\n  }, {\n    key: \"getLeavesSuper\",\n    value: function getLeavesSuper(ubn, email, idToken) {\n      var _this5 = this;\n\n      try {\n        this.setState({\n          loading: true\n        });\n        var URL_GETLEAVES = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/leave/get\";\n        var url = URL_GETLEAVES + \"?ubn=\".concat(ubn, \"&query=supervisor&value=\").concat(email);\n        var header = {\n          Authorization: idToken\n        };\n        fetch(url, {\n          method: 'get',\n          headers: header\n        }).then(function (res) {\n          return res.json();\n        }).then(function (result) {\n          if (result) {\n            _this5.convertData(result.list);\n          } else {\n            alert(\"getLeavesSuper no result\");\n          }\n        })[\"catch\"](function (error) {\n          alert(error.message);\n        });\n      } catch (err) {\n        throw err;\n      }\n    }\n  }, {\n    key: \"convertData\",\n    value: function convertData(list) {\n      try {\n        var newList = [];\n\n        for (var i = 0; i < list.length; i++) {\n          var data = {\n            \"startDate\": list[i].startDate,\n            \"endDate\": list[i].endDate,\n            \"leaveType\": list[i].leaveType,\n            \"substitute\": JSON.parse(list[i].substitute).name,\n            \"status\": list[i].status,\n            \"leaveReason\": list[i].leaveReason,\n            \"rejectReason\": list[i].rejectReason\n          };\n          newList.push(data);\n        }\n\n        this.setState({\n          data_origin: newList\n        });\n        this.globalSearch();\n      } catch (err) {\n        throw err;\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this6 = this;\n\n      var MyLoader = function MyLoader() {\n        return __jsx(Loader, {\n          loading: _this6.state.loading,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 274\n          },\n          __self: this\n        });\n      };\n\n      var columns = [{\n        Header: '開始日期',\n        accessor: 'startDate',\n        width: 90\n      }, {\n        Header: '結束日期',\n        accessor: 'endDate',\n        width: 90\n      }, {\n        Header: '假勤類別',\n        accessor: 'leaveType',\n        width: 90\n      }, {\n        Header: '代理人',\n        accessor: 'substitute',\n        show: false\n      }, {\n        Header: '簽核狀態',\n        accessor: 'status',\n        width: 90\n      }, {\n        Header: '請假原因',\n        accessor: 'leaveReason',\n        show: false\n      }, {\n        Header: '拒絕原因',\n        accessor: 'rejectReason',\n        show: false\n      }];\n      var classes = useStyles;\n      return __jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 307\n        },\n        __self: this\n      }, __jsx(Head, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 309\n        },\n        __self: this\n      }, __jsx(\"script\", {\n        src: \"https://d.line-scdn.net/liff/1.0/sdk.js\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 310\n        },\n        __self: this\n      })), __jsx(Grid, {\n        container: true,\n        spacing: 1,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 312\n        },\n        __self: this\n      }, __jsx(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      }, __jsx(Grid, {\n        container: true,\n        justify: \"center\",\n        spacing: 3,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 314\n        },\n        __self: this\n      }, __jsx(Grid, {\n        key: 1,\n        item: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      }, __jsx(FormControl, {\n        margin: \"normal\",\n        style: {\n          minWidth: 150\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 316\n        },\n        __self: this\n      }, __jsx(InputLabel, {\n        id: \"role-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 317\n        },\n        __self: this\n      }, \"\\u7C3D\\u6838\\u8EAB\\u4EFD\"), __jsx(Select, {\n        labelId: \"role-label\",\n        id: \"role\",\n        value: this.state.role,\n        onChange: this.handleRoleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318\n        },\n        __self: this\n      }, __jsx(MenuItem, {\n        value: \"substitute\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324\n        },\n        __self: this\n      }, \"\\u4EE3\\u7406\\u4EBA\"), __jsx(MenuItem, {\n        value: \"supervisor\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 325\n        },\n        __self: this\n      }, \"\\u4E3B\\u7BA1\")))), __jsx(Grid, {\n        key: 2,\n        item: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330\n        },\n        __self: this\n      }, __jsx(FormControl, {\n        margin: \"normal\",\n        style: {\n          minWidth: 150\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331\n        },\n        __self: this\n      }, __jsx(InputLabel, {\n        id: \"status-label\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, \"\\u7C3D\\u6838\\u72C0\\u614B\"), __jsx(Select, {\n        labelId: \"status-label\",\n        id: \"status\",\n        value: this.state.status,\n        onChange: this.handleStatusChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333\n        },\n        __self: this\n      }, __jsx(MenuItem, {\n        value: \"not signed\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 339\n        },\n        __self: this\n      }, \"\\u672A\\u7C3D\\u6838\"), __jsx(MenuItem, {\n        value: \"signed\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 340\n        },\n        __self: this\n      }, \"\\u5DF2\\u7C3D\\u6838\")))), __jsx(Grid, {\n        key: 3,\n        item: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345\n        },\n        __self: this\n      }, __jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 346\n        },\n        __self: this\n      }, this.state.data ? __jsx(ReactTable, {\n        LoadingComponent: MyLoader,\n        data: this.state.data,\n        getTrProps: function getTrProps(state, rowInfo, column, instance) {\n          return {\n            onClick: function onClick(e) {\n              return alert(\"\\u958B\\u59CB\\u65E5\\u671F\\uFF1A\".concat(rowInfo.row.startDate, \"\\n\\u7D50\\u675F\\u65E5\\u671F\\uFF1A\").concat(rowInfo.row.endDate, \"\\n\\u5047\\u52E4\\u985E\\u5225\\uFF1A\").concat(rowInfo.row.leaveType, \"\\n\\u4EE3\\u7406\\u4EBA\\uFF1A\").concat(rowInfo.row.substitute, \"\\n\\u7C3D\\u6838\\u72C0\\u614B\\uFF1A\").concat(rowInfo.row.status, \"\\n\\u62D2\\u7D55\\u539F\\u56E0\\uFF1A\").concat(rowInfo.row.rejectReason));\n            }\n          };\n        },\n        columns: columns,\n        defaultPageSize: 10,\n        pageSizeOptions: [10, 15],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 348\n        },\n        __self: this\n      }) : __jsx(ReactTable, {\n        LoadingComponent: MyLoader,\n        data: leaves,\n        columns: columns,\n        defaultPageSize: 10,\n        pageSizeOptions: [10, 15],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 359\n        },\n        __self: this\n      })))))));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport { App as default };","map":{"version":3,"sources":["/Users/yan/ezbot-web/app/pages/viewSign.js"],"names":["Head","React","Component","ReactTable","styled","window","Loader","require","makeStyles","InputLabel","MenuItem","FormHelperText","FormControl","Select","Grid","useStyles","theme","formControl","margin","spacing","minWidth","fullWidth","selectEmpty","marginTop","liff","BOX","div","leaves","App","props","event","setState","role","target","value","getLeavesSub","state","ubn","name","email","idToken","getLeavesSuper","err","status","globalSearch","loading","role_select","status_select","filteredData","data_origin","filter","data","fal","liffInit","init","userId","context","accessToken","getAccessToken","URL_CHECKEXIST","body","fetch","method","headers","then","res","text","result","lineAuth","alert","location","replace","url","json","staff","token","error","message","URL_GETLEAVES","header","Authorization","convertData","list","newList","i","length","startDate","endDate","leaveType","JSON","parse","substitute","leaveReason","rejectReason","push","MyLoader","columns","Header","accessor","width","show","classes","handleRoleChange","handleStatusChange","rowInfo","column","instance","onClick","e","row"],"mappings":"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","sourcesContent":["import Head from 'next/head';\nimport React, { Component } from 'react';\nimport ReactTable from \"react-table\";\nimport styled from 'styled-components';\nimport \"react-table/react-table.css\";\nimport window from 'global'\nimport Loader from \"./loader\";\nrequire('react-month-picker-input/dist/react-month-picker-input.css');\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Grid from '@material-ui/core/Grid';\nconst useStyles = makeStyles(theme => ({\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n    fullWidth: true,\n  },\n  selectEmpty: {\n    marginTop: theme.spacing(2),\n  },\n}));\n\nconst liff = window.liff;\nconst BOX = styled.div`\n  margin: 5.5em auto;\n`;\n\nvar leaves;\n\n\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      data : null,\n      data_origin : null,\n      role : \"substitute\",\n      status: \"not signed\",\n      loading: fal\n    };\n  }\n\n  componentDidMount() {\n    this.liffInit();\n  }\n\n  liffInit() {\n    try {\n      liff.init(data => {\n        const userId = data.context.userId;\n        const accessToken = liff.getAccessToken();\n        const URL_CHECKEXIST = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\";\n        const body = {\n          userId: userId\n        };\n        fetch(URL_CHECKEXIST, {\n          method: 'post',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(body)\n        }).then((res) => {\n          return res.text();\n        }).then(result => {\n          if (result) {\n              this.lineAuth(userId, accessToken);\n          } else {\n              alert(\"請登入以查看假單\");\n              window.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\");\n          }\n        })\n      }, err => {\n        alert(\"error\");\n      });\n    } catch (err) {\n      throw(err);\n    }\n  }\n  \n  lineAuth (userId, accessToken)  {\n    try {\n      const url = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n      const body = {\n          userId: userId,\n          accessToken: accessToken\n        };\n      fetch(url, {\n          method: 'post',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(body)\n        }).then((res) => {\n          return res.json();\n        }).then(result => {\n          if (result) {\n              const ubn = result.staff.ubn;\n              const email = result.staff.email;\n              const name = result.staff.name;\n              const idToken = result.token.idToken;\n              this.setState({\n                ubn: ubn,\n                name: name,\n                email: email,\n                idToken: idToken\n              })\n              if (this.state.role == \"substitute\") {\n                this.getLeavesSub(this.state.ubn, this.state.name, this.state.email, this.state.idToken);\n              } else if (this.state.role == \"supervisor\") {\n                this.getLeavesSuper(this.state.ubn, this.state.email, this.state.idToken);\n              }\n          } else {\n              alert(\"lineAuth no result\");\n\n          }\n        }).catch(function (error) {\n          alert(error.message);\n        })\n      } catch (err) {\n        throw(err);\n      }\n  }\n\n  getLeavesSub (ubn, name, email, idToken) {\n    try {\n      this.setState({ loading: true });\n      const URL_GETLEAVES = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/leave/get\";\n      const url = URL_GETLEAVES + `?ubn=${ubn}&query=substitute&value={\"name\":\"${name}\",\"email\":\"${email}\"}`;\n      const header = {\n          Authorization: idToken\n        };\n      fetch(url, {\n          method: 'get',\n          headers: header\n      }).then((res) => {\n          return res.json();\n      }).then(result => {\n          if (result) {\n            this.convertData(result.list);\n      } else {\n          alert(\"getLeavesSub no result\");\n      }\n      }).catch(function (error) {\n          alert(error.message);\n      })\n    } catch (err) {\n      throw(err);\n    }\n  }\n\n  getLeavesSuper (ubn, email, idToken) {\n    try {\n      this.setState({ loading: true });\n      const URL_GETLEAVES = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/leave/get\";\n      const url = URL_GETLEAVES + `?ubn=${ubn}&query=supervisor&value=${email}`;\n      const header = {\n          Authorization: idToken\n        };\n      fetch(url, {\n          method: 'get',\n          headers: header\n      }).then((res) => {\n          return res.json();\n      }).then(result => {\n          if (result) {\n            this.convertData(result.list);\n      } else {\n          alert(\"getLeavesSuper no result\");\n      }\n      }).catch(function (error) {\n          alert(error.message);\n      })\n    } catch (err) {\n      throw(err);\n    }\n  }\n\n  convertData (list)  {\n    try {\n      var newList = [];\n      for (var i = 0; i < list.length; i++) {\n        const data = {\n          \"startDate\": list[i].startDate,\n          \"endDate\": list[i].endDate,\n          \"leaveType\": list[i].leaveType,\n          \"substitute\": JSON.parse(list[i].substitute).name,\n          \"status\": list[i].status,\n          \"leaveReason\": list[i].leaveReason,\n          \"rejectReason\": list[i].rejectReason\n        };\n        newList.push(data);\n      }\n      this.setState({\n        data_origin: newList \n      })\n      this.globalSearch();\n    } catch (err) {\n      throw(err);\n    }\n  }\n\n  handleRoleChange = event => {\n    try{\n      this.setState({ role: event.target.value }, () => {\n        if (event.target.value == \"substitute\") {\n          this.getLeavesSub(this.state.ubn, this.state.name, this.state.email, this.state.idToken);\n        } else if (event.target.value == \"supervisor\") {\n          this.getLeavesSuper(this.state.ubn, this.state.email, this.state.idToken);\n        }\n      });\n    } catch (err) {\n      throw(err);\n    }\n  };\n\n  handleStatusChange = event => {\n    try{\n      this.setState({ status: event.target.value }, () => {\n        //console.log(event.target.value);\n        this.globalSearch();\n      });\n    } catch (err) {\n      throw(err);\n    }\n  };\n\n  globalSearch = () => {\n    try {\n      this.setState({ loading: true });\n      let role_select = this.state.role;\n      let status_select = this.state.status;\n\n      let filteredData = this.state.data_origin.filter(value => {\n        if (role_select == \"substitute\") {\n          switch (status_select) {\n            case \"signed\":\n              return (  \n                value.status != \"等待簽核\"    \n              );\n            case \"not signed\":\n              return (  \n                value.status == \"等待簽核\"    \n              );\n            default:\n              throw 'Option not supported';\n          }\n        } else if (role_select == \"supervisor\") {\n          switch (status_select) {\n            case \"signed\":\n              return (  \n                value.status == \"同意 (主管)\" || value.status == \"拒絕 (主管)\"    \n              );\n            case \"not signed\":\n              return (  \n                value.status == \"同意 (代理人)\"   \n              );\n            default:\n              throw 'Option not supported';\n          }\n        }\n      });\n      this.setState({ data: filteredData, loading: false });\n    } catch (err) {\n      throw(err);\n    }\n  };\n  \n  render() {\n    const MyLoader = () => <Loader loading={this.state.loading} />;\n    const columns = [{\n      Header: '開始日期',\n      accessor: 'startDate',\n      width: 90\n    },{\n      Header: '結束日期',\n      accessor: 'endDate',\n      width: 90\n    },{\n      Header: '假勤類別',\n      accessor: 'leaveType',\n      width: 90\n    },{\n      Header: '代理人',\n      accessor: 'substitute',\n      show: false\n    },{\n      Header: '簽核狀態',\n      accessor: 'status',\n      width: 90\n    },{\n      Header: '請假原因',\n      accessor: 'leaveReason',\n      show: false\n    },{\n      Header: '拒絕原因',\n      accessor: 'rejectReason',\n      show: false\n    }];\n    const classes = useStyles;\n\n    return (\n      <div>\n        \n        <Head>\n          <script src=\"https://d.line-scdn.net/liff/1.0/sdk.js\"></script>\n        </Head>\n        <Grid container spacing={1}>\n          <Grid item xs={12}>\n            <Grid container justify=\"center\" spacing={3}>\n              <Grid key={1} item>\n                <FormControl margin=\"normal\" style={{minWidth: 150}} >\n                  <InputLabel id=\"role-label\">簽核身份</InputLabel>\n                  <Select\n                    labelId=\"role-label\"\n                    id=\"role\"\n                    value={this.state.role}\n                    onChange={this.handleRoleChange}\n                  >\n                    <MenuItem value={\"substitute\"}>代理人</MenuItem>\n                    <MenuItem value={\"supervisor\"}>主管</MenuItem>\n                  </Select>\n                </FormControl>\n              </Grid>\n              \n              <Grid key={2} item>\n                <FormControl margin=\"normal\" style={{minWidth: 150}}>\n                  <InputLabel id=\"status-label\">簽核狀態</InputLabel>\n                  <Select\n                    labelId=\"status-label\"\n                    id=\"status\"\n                    value={this.state.status}\n                    onChange={this.handleStatusChange}\n                  >\n                    <MenuItem value={\"not signed\"}>未簽核</MenuItem>\n                    <MenuItem value={\"signed\"}>已簽核</MenuItem>\n                  </Select>\n                </FormControl>\n              </Grid>\n             \n              <Grid key={3} item>\n                <div>\n                  {this.state.data ?\n                    <ReactTable\n                      LoadingComponent={MyLoader}\n                      data={this.state.data}\n                      getTrProps={(state, rowInfo, column, instance) => ({\n                        onClick: e => alert(\n                      `開始日期：${rowInfo.row.startDate}\\n結束日期：${rowInfo.row.endDate}\\n假勤類別：${rowInfo.row.leaveType}\\n代理人：${rowInfo.row.substitute}\\n簽核狀態：${rowInfo.row.status}\\n拒絕原因：${rowInfo.row.rejectReason}`)\n                      })}\n                      columns={columns}\n                      defaultPageSize = {10}\n                      pageSizeOptions = {[10, 15]}\n                    /> :\n                    <ReactTable\n                      LoadingComponent={MyLoader}\n                      data={leaves}\n                      columns={columns}\n                      defaultPageSize = {10}\n                      pageSizeOptions = {[10, 15]}\n                    />\n                  }\n                </div>\n              </Grid>\n            </Grid>\n          </Grid>\n        </Grid>\n        \n      </div>    \n    );\n  }\n}\n\n"]},"metadata":{},"sourceType":"module"}