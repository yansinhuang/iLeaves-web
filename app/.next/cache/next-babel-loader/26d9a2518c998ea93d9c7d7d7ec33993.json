{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nvar _jsxFileName = \"/Users/yan/ezbot-web/app/pages/reject_sub.js\";\nvar __jsx = React.createElement;\n// Render Prop\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport { TextField } from 'formik-material-ui';\nimport fetch from 'isomorphic-unfetch';\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport Head from 'next/head';\nimport window from 'global';\nimport { Select } from 'material-ui-formik-components/Select';\nimport { DatePicker, MuiPickersUtilsProvider } from '@material-ui/pickers';\nimport LuxonUtils from '@date-io/luxon';\n\nrequire(\"react-datepicker/dist/react-datepicker.css\");\n\nvar dateFormat = require('dateformat');\n\nconst liff = window.liff;\nconst BOX = styled.div`\n  margin: 5.5em auto;\n`;\nconst TITLE = styled.h2`\n  color: #F8F9F9;\n  font-family: Candara;\n  text-align: center;\n  margin-bottom:-2em;\n`;\nconst CONTAINER = styled.div`\n  background: #F7F9FA;\n  height: auto;\n  width: 90%;\n  margin: 5em auto;\n  box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.4);\n\n  label {\n    font-family: Candara;\n    color: #1C2833;\n    font-size: 1.2em;\n    font-weight: 400;\n  }\n`;\nconst MYFORM = styled(Form)`\n  text-align: center;\n  padding-top: 2em;\n  padding-bottom: 2em;\n`;\nconst FIELD = styled(Field)`\n  width: 80%;\n  margin: auto;\n`;\nconst BUTTON = styled(Button)`\n  width: 80%;\n  variant: contained;\n`;\nconst TomatoButton = styled.button`\n  color: tomato;\n  border-color: tomato;\n  width: 80%;\n`;\nexport default class App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      userId: null\n    };\n  }\n\n  componentDidMount() {\n    this.liffInit();\n  }\n\n  getQuery() {\n    let urlParams = new URLSearchParams(window.location.search);\n    urlParams = urlParams.toString().split(\"&\");\n    const ubn = urlParams[0].split(\"=\")[1];\n    const leaveId = urlParams[1].split(\"=\")[1];\n    this.setState({\n      leaveId: leaveId\n    });\n  }\n\n  liffInit() {\n    try {\n      liff.init(data => {\n        const userId = data.context.userId;\n        const accessToken = liff.getAccessToken();\n        const URL_CHECKEXIST = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\";\n        const body = {\n          userId: userId\n        };\n        fetch(URL_CHECKEXIST, {\n          method: 'post',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: _JSON$stringify(body)\n        }).then(res => {\n          return res.text();\n        }).then(result => {\n          if (result) {\n            this.setState({\n              userId: userId\n            });\n            this.lineAuth(userId, accessToken);\n          } else {\n            alert(\"請登入以查看假單\");\n            window.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\");\n          }\n        });\n      }, err => {\n        alert(err.message);\n      });\n    } catch (err) {\n      next(err);\n    }\n  }\n\n  lineAuth(userId, accessToken) {\n    try {\n      const url = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n      const body = {\n        userId: userId,\n        accessToken: accessToken\n      };\n      fetch(url, {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: _JSON$stringify(body)\n      }).then(res => {\n        return res.json();\n      }).then(result => {\n        if (result) {\n          const ubn = result.staff.ubn; //const department = result.staff.department;\n          //const email = result.staff.email;\n\n          const idToken = result.token.idToken;\n          this.setState({\n            Authorization: idToken,\n            ubn: ubn\n          }); //this.getSubstitutes(ubn, department, idToken);\n        } else {\n          alert(\"lineAuth no result\");\n        }\n      }).catch(function (error) {\n        alert(error.message);\n      });\n    } catch (err) {\n      next(err);\n    }\n  }\n\n  updateLeave(values) {\n    try {\n      const URL_UPDATELEAVE = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/leave/update\";\n      fetch(URL_UPDATELEAVE, {\n        method: 'post',\n        headers: {\n          \"Authorization\": this.state.Authorization\n        },\n        body: _JSON$stringify(values)\n      }).then(res => {\n        return res.text();\n      }).then(result => {\n        if (result) {\n          liff.closeWindow();\n        } else {\n          alert(\"updateLeave error\");\n        }\n      }).catch(function (error) {\n        alert(error.message);\n      });\n    } catch (err) {\n      next(err);\n    }\n  }\n\n  render() {\n    return __jsx(BOX, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, __jsx(Head, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }, __jsx(\"script\", {\n      src: \"https://d.line-scdn.net/liff/1.0/sdk.js\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    })), __jsx(\"body\", {\n      style: {\n        background: '#34495E'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191\n      },\n      __self: this\n    }, __jsx(BOX, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, __jsx(Formik, {\n      initialValues: {\n        rejectReason: ''\n      },\n      validate: values => {\n        const errors = {}; // check for rejectReason\n\n        if (!values.rejectReason) {\n          errors.reason = 'Required';\n        }\n\n        return errors;\n      },\n      onSubmit: (values, {\n        setSubmitting\n      }) => {\n        values.status = \"拒絕 (代理人)\";\n        values.leaveId = this.state.leaveId;\n        values.ubn = this.state.ubn;\n        this.submitForm(values);\n        setSubmitting(false); //console.log('submitting', values);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, ({\n      isSubmitting,\n      values,\n      setFieldValue\n    }) => __jsx(CONTAINER, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, __jsx(MYFORM, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, __jsx(FIELD, {\n      type: \"reason\",\n      name: \"reason\",\n      label: \"\\u62D2\\u7D55\\u539F\\u56E0\",\n      component: TextField,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217\n      },\n      __self: this\n    }), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }), __jsx(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }), __jsx(BUTTON, {\n      type: \"submit\",\n      fontFamily: \"Candara\",\n      variant: \"contained\",\n      color: \"secondary\",\n      disabled: isSubmitting,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, \"\\u9001\\u51FA\")))))));\n  }\n\n}","map":{"version":3,"sources":["/Users/yan/ezbot-web/app/pages/reject_sub.js"],"names":["React","Component","styled","Formik","Form","Field","ErrorMessage","TextField","fetch","Button","Box","Head","window","Select","DatePicker","MuiPickersUtilsProvider","LuxonUtils","require","dateFormat","liff","BOX","div","TITLE","h2","CONTAINER","MYFORM","FIELD","BUTTON","TomatoButton","button","App","constructor","props","state","userId","componentDidMount","liffInit","getQuery","urlParams","URLSearchParams","location","search","toString","split","ubn","leaveId","setState","init","data","context","accessToken","getAccessToken","URL_CHECKEXIST","body","method","headers","then","res","text","result","lineAuth","alert","replace","err","message","next","url","json","staff","idToken","token","Authorization","catch","error","updateLeave","values","URL_UPDATELEAVE","closeWindow","render","background","rejectReason","errors","reason","setSubmitting","status","submitForm","isSubmitting","setFieldValue"],"mappings":"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","sourcesContent":["// Render Prop\nimport React, { Component } from 'react';\nimport styled from 'styled-components';\nimport { Formik, Form, Field, ErrorMessage } from 'formik';\nimport { TextField } from 'formik-material-ui';\nimport fetch from 'isomorphic-unfetch';\nimport Button from \"@material-ui/core/Button\";\nimport Box from \"@material-ui/core/Box\";\nimport Head from 'next/head';\nimport window from 'global';\nimport { Select } from 'material-ui-formik-components/Select';\nimport {\n  DatePicker,\n  MuiPickersUtilsProvider,\n} from '@material-ui/pickers';\nimport LuxonUtils from '@date-io/luxon';\nrequire( \"react-datepicker/dist/react-datepicker.css\");\nvar dateFormat = require('dateformat');\n\nconst liff = window.liff;\nconst BOX = styled.div`\n  margin: 5.5em auto;\n`;\nconst TITLE = styled.h2`\n  color: #F8F9F9;\n  font-family: Candara;\n  text-align: center;\n  margin-bottom:-2em;\n`;\nconst CONTAINER = styled.div`\n  background: #F7F9FA;\n  height: auto;\n  width: 90%;\n  margin: 5em auto;\n  box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.4);\n\n  label {\n    font-family: Candara;\n    color: #1C2833;\n    font-size: 1.2em;\n    font-weight: 400;\n  }\n`;\nconst MYFORM = styled(Form)`\n  text-align: center;\n  padding-top: 2em;\n  padding-bottom: 2em;\n`;\nconst FIELD = styled(Field)`\n  width: 80%;\n  margin: auto;\n`;\nconst BUTTON = styled(Button)`\n  width: 80%;\n  variant: contained;\n`;\nconst TomatoButton = styled.button`\n  color: tomato;\n  border-color: tomato;\n  width: 80%;\n`;\n\n\nexport default class App extends Component {\n    constructor(props) {\n      super(props);\n  \n      this.state = {\n        userId : null\n      };\n    }\n\n    componentDidMount() {\n      this.liffInit();\n    }\n\n    getQuery() {\n        let urlParams = new URLSearchParams(window.location.search);\n        urlParams = urlParams.toString().split(\"&\");\n        const ubn = urlParams[0].split(\"=\")[1];\n        const leaveId = urlParams[1].split(\"=\")[1];\n        this.setState({\n            leaveId: leaveId\n        })\n      }\n  \n    liffInit() {\n      try {\n        liff.init(data => {\n          const userId = data.context.userId;\n          const accessToken = liff.getAccessToken();\n          const URL_CHECKEXIST = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/checkExist\";\n          const body = {\n            userId: userId\n          };\n          fetch(URL_CHECKEXIST, {\n            method: 'post',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(body)\n          }).then((res) => {\n            return res.text();\n          }).then(result => {\n            if (result) {\n                this.setState({\n                  userId: userId\n              })\n              this.lineAuth(userId, accessToken);\n            } else {\n                alert(\"請登入以查看假單\");\n                window.location.replace(\"https://teddybear-dev.firebaseapp.com/signIn\");\n            }\n          })\n        }, err => {\n          alert(err.message);\n        });\n      } catch (err) {\n        next(err);\n      }\n    }\n    \n    lineAuth (userId, accessToken)  {\n      try {\n        const url = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/staff/lineAuth\";\n        const body = {\n            userId: userId,\n            accessToken: accessToken\n          };\n        fetch(url, {\n          method: 'post',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(body)\n        }).then((res) => {\n          return res.json();\n        }).then(result => {\n          if (result) {\n            const ubn = result.staff.ubn;\n            //const department = result.staff.department;\n            //const email = result.staff.email;\n            const idToken = result.token.idToken;\n            this.setState({\n              Authorization: idToken,\n              ubn: ubn\n            })\n            //this.getSubstitutes(ubn, department, idToken);\n          } else {\n              alert(\"lineAuth no result\");\n          }\n        }).catch(function (error) {\n          alert(error.message);\n        })\n      } catch (err) {\n        next(err);\n      }\n    }\n    \n    updateLeave (values) {\n      try {\n        const URL_UPDATELEAVE = \"https://us-central1-teddybear-dev.cloudfunctions.net/api/leave/update\";\n        fetch(URL_UPDATELEAVE, {\n          method: 'post',\n          headers: {\n            \"Authorization\": this.state.Authorization\n          },\n          body: JSON.stringify(values)\n        }).then((res) => {\n          return res.text();\n        }).then(result => {\n          if (result) {\n            liff.closeWindow();\n          } else {\n              alert(\"updateLeave error\");\n          }\n        }).catch(function (error) {\n          alert(error.message);\n        })\n      } catch (err) {\n        next(err);\n      }\n    }\n  \n    render() {\n      return (\n        <BOX>\n          <Head>\n            <script src=\"https://d.line-scdn.net/liff/1.0/sdk.js\"></script>\n          </Head>\n          <body style={{background:'#34495E'}}>\n            <BOX>\n              <Formik\n                initialValues={{ rejectReason: '' }}\n                validate={values => {\n                  const errors = {};\n                  // check for rejectReason\n                  if (!values.rejectReason) {\n                      errors.reason = 'Required';\n                  }\n                  \n                  return errors;\n                  \n                }}\n                onSubmit={(values, { setSubmitting }) => {\n                  values.status = \"拒絕 (代理人)\";\n                  values.leaveId = this.state.leaveId;\n                  values.ubn = this.state.ubn;\n                  this.submitForm(values);\n                    setSubmitting(false);\n                  //console.log('submitting', values);\n                }}\n              >\n              {({ isSubmitting, values, setFieldValue}) => (\n                <CONTAINER>\n                  <MYFORM>\n                    <FIELD \n                      type=\"reason\" \n                      name=\"reason\" \n                      label = \"拒絕原因\" \n                      component = { TextField }\n                    />\n\n                    <br></br>\n                    <br></br>\n\n                    <BUTTON\n                      type=\"submit\"\n                      fontFamily= \"Candara\"\n                      variant=\"contained\"\n                      color=\"secondary\"\n                      disabled={isSubmitting}\n                    >\n                    送出\n                    </BUTTON>\n                    \n                  </MYFORM>\n                </CONTAINER>\n              )}\n              </Formik>\n            </BOX>\n          </body>\n        </BOX>   \n      );\n    }\n  }"]},"metadata":{},"sourceType":"module"}